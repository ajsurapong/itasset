<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.bootstrap4.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.3.2/bootbox.min.js"></script> -->
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.3/js/responsive.bootstrap4.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>



    <!-- <link rel="stylesheet" href="assets/vendor/bootstrap/css/bootstrap.min.css"> -->
    <link href="/assets/vendor/fonts/circular-std/style.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/libs/css/style.css">
    <link rel="stylesheet" href="/assets/vendor/fonts/fontawesome/css/fontawesome-all.css">
    <!-- <link rel="stylesheet" href="assets/vendor/vector-map/jqvmap.css">
    <link href="assets/vendor/jvectormap/jquery-jvectormap-2.0.2.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/vendor/charts/morris-bundle/morris.css">
    <link rel="stylesheet" type="text/css" href="assets/vendor/daterangepicker/daterangepicker.css" /> -->
    <!-- <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- <link rel="stylesheet" href="https://www.cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css" /> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script> -->
    <!-- alert box -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.1/sweetalert.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-sweetalert/1.0.1/sweetalert.css">

    <link type="text/css" href="//gyrocode.github.io/jquery-datatables-checkboxes/1.2.12/css/dataTables.checkboxes.css"
        rel="stylesheet" />
    <script type="text/javascript"
        src="//gyrocode.github.io/jquery-datatables-checkboxes/1.2.12/js/dataTables.checkboxes.min.js"></script>

    <!-- Button export -->
    <script src="https://cdn.datatables.net/buttons/1.6.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script> -->
    <script text="script" src="/JS_Files/vfs_fonts.js"></script>
    <!-- <script src="<?=base_url('js/vfs_fonts.js')?>"></script> -->
    <script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.html5.min.js"></script>
    <!-- <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css"> -->
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.1/css/buttons.dataTables.min.css">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css"> -->
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.colVis.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.print.min.js"></script>

    <title>ครุภัณฑ์</title>

    <style>
        #Location {
            width: 73px;
            height: 20px;

        }

        #Status {
            width: 70px;
            height: 20px;

        }
    </style>

    <script>
        var table
        var user
        var SelectedYear
        var YearFilter
        $(document).ready(function () {
            var yyyy = new Date().getFullYear() + 543;
            $(".atyear1").html(yyyy)
            $("form").submit(function (e) {
                e.preventDefault();
                fileName = $("#fileUpload").val();
                fileExtension = fileName.replace(/^.*\./, '');

                if (document.getElementById("fileUpload").files.length == 0) {
                    //or use jQuery

                    swal({
                        title: "กรุณาเลือกไฟล์",
                        type: "info",
                        confirmButtonClass: "btn-primary rounded",
                        confirmButtonText: "ตกลง",
                        closeOnConfirm: true,
                    })

                    return;
                }
                else if (fileExtension != "xlsx") {
                    // alert("please select only excel file");

                    swal({
                        title: "กรุณาเลือกเฉพาะไฟล์ Excel",
                        type: "info",
                        confirmButtonClass: "btn-primary rounded",
                        confirmButtonText: "ตกลง",
                        closeOnConfirm: true,
                    })
                }
                else {

                    const formData = new FormData(this);
                    var today = new Date();


                    $.ajax({
                        method: "GET",
                        url: "/api/item/dashboard/showuser" //ดึง status ex: [{"Status":0}]
                    }).done(function (data, state, xhr) {

                        if (data.length > 1) {

                            swal({
                                title: "ไม่สามารถนำเข้าไฟล์เพิ่มเติม",
                                text: "เนื่องจากปีนี้ได้ทำการตรวจนับแล้ว",
                                type: "info",
                                showCancelButton: false,
                                confirmButtonClass: "btn-primary rounded",
                                // cancelButtonClass: "btn-primary",
                                confirmButtonText: "ตกลง",
                                // cancelButtonText: "ยกเลิก",
                                closeOnConfirm: true,
                                // closeOnCancel: true
                            })
                        } else {
                            $.ajax({
                                method: "GET",
                                url: "/api/item/dashboard/showuser"
                            }).done(function (dataSet, state, xhr) {
                                if (dataSet.length != 0) {

                                    swal({
                                        title: "ปีนี้ได้มีการนำเข้าไฟล์แล้ว",
                                        text: "ถ้านำเข้าซ้ำ จะทำการล้างข้อมูลเก่าทั้งหมด",
                                        type: "warning",
                                        showCancelButton: true,
                                        confirmButtonClass: "btn-danger rounded",
                                        cancelButtonClass: "btn-primary rounded",
                                        confirmButtonText: "ยืนยัน",
                                        cancelButtonText: "ยกเลิก",
                                        closeOnConfirm: false,
                                        closeOnCancel: true,
                                        showLoaderOnConfirm: true
                                    },
                                        function (isConfirm) {
                                            setTimeout(function () {
                                                if (isConfirm) {

                                                    $.ajax({
                                                        method: "POST",
                                                        url: "/api/uploading/" + user,
                                                        data: formData,
                                                        contentType: false,     //tell jQuery not to add a Content-Type header for us
                                                        processData: false,      //tell jQuery not to convert the formData object to a string
                                                        success: function (data, state, xhr) {
                                                            if (data == '1') {
                                                                swal({
                                                                    title: "<small>บันทึกสำเร็จ</small>",
                                                                    // text: "บันทึกสำเร็จ",
                                                                    type: "success",
                                                                    showCancelButton: false,
                                                                    confirmButtonClass: "btn-success rounded",
                                                                    confirmButtonText: "ยืนยัน",
                                                                    // closeOnConfirm: false,
                                                                    closeOnConfirm: true,
                                                                    html: true,
                                                                    closeOnCancel: true
                                                                }, function (isConfirm) {
                                                                    window.location.reload()
                                                                });
                                                            }
                                                            else {
                                                                swal({
                                                                    title: "นำเข้าเอกสารล้มเหลว",
                                                                    text: "ข้อมูลซ้ำหรือไม่ครบ \n" +data,
                                                                    type: "error",
                                                                    showCancelButton: false,
                                                                    confirmButtonClass: "btn-primary rounded",
                                                                    // cancelButtonClass: "btn-primary",
                                                                    confirmButtonText: "ตกลง",
                                                                    // cancelButtonText: "ยกเลิก",
                                                                    closeOnConfirm: true,
                                                                    // closeOnCancel: true
                                                                }, function (isConfirm) {
                                                                    window.location.reload()
                                                                });
                                                            }


                                                        },
                                                        error: function (xhr, state, err) {
                                                            $(".btn-sm").hide();
                                                            $(".but").append('<input class="btn btn-sm" type="button" value = "ตกลง" onclick = "location.reload()" style="float: right; background-color: #0a72c1; color:white">')
                                                            $(".alertText").html(xhr.responseText)
                                                            $("#alertmodal").modal();

                                                        }
                                                    });


                                                }
                                            }, 2000);

                                        });


                                }
                                else {
                                    swal({
                                        title: "ยืนยันนำเข้าข้อมูล",
                                        // text: "Submit to run ajax request",
                                        type: "info",
                                        showCancelButton: true,
                                        showLoaderOnConfirm: true,
                                        closeOnCancel: true,
                                        closeOnConfirm: false,
                                        cancelButtonClass: "btn-secondary rounded",
                                        cancelButtonText: "ยกเลิก",
                                        confirmButtonText: "ยืนยัน",
                                    }, function (isConfirm) {
                                        setTimeout(function () {
                                            // swal("Ajax request finished!");
                                            // swal("Good job!", "You clicked the button!", "success")
                                            if (isConfirm) {

                                                $.ajax({
                                                    method: "POST",
                                                    url: "/api/uploading/" + user,
                                                    data: formData,
                                                    contentType: false,     //tell jQuery not to add a Content-Type header for us
                                                    processData: false,      //tell jQuery not to convert the formData object to a string
                                                    success: function (data, state, xhr) {
                                                        if (data == '1') {
                                                            swal({
                                                                title: "<small>บันทึกสำเร็จ</small>",
                                                                // text: "บันทึกสำเร็จ",
                                                                type: "success",
                                                                showCancelButton: false,
                                                                confirmButtonClass: "btn-success rounded",
                                                                confirmButtonText: "ยืนยัน",
                                                                // closeOnConfirm: false,
                                                                closeOnConfirm: true,
                                                                html: true,
                                                                closeOnCancel: true
                                                            }, function (isConfirm) {
                                                                window.location.reload()
                                                            });
                                                        }
                                                        else {
                                                            swal({
                                                                title: "นำเข้าเอกสารล้มเหลว",
                                                                text: "ข้อมูลซ้ำหรือไม่ครบ(" +data+')',
                                                                type: "error",
                                                                showCancelButton: false,
                                                                confirmButtonClass: "btn-primary rounded",
                                                                // cancelButtonClass: "btn-primary",
                                                                confirmButtonText: "ตกลง",
                                                                // cancelButtonText: "ยกเลิก",
                                                                closeOnConfirm: true,
                                                                // closeOnCancel: true
                                                            }, function (isConfirm) {
                                                                window.location.reload()
                                                            });
                                                        }


                                                    },
                                                    error: function (xhr, state, err) {
                                                        $(".btn-sm").hide();
                                                        $(".but").append('<input class="btn btn-sm" type="button" value = "ตกลง" onclick = "location.reload()" style="float: right; background-color: #0a72c1; color:white">')
                                                        $(".alertText").html(xhr.responseText)
                                                        $("#alertmodal").modal();

                                                    }
                                                });


                                            }
                                        }, 2000);



                                    });

                                }
                            })
                        }
                    }).fail(function (xhr, state, error) {
                        $(".alertText").html(xhr.responseText)
                        $("#alertmodal").modal();

                    });
                }


            });


            // //====================================== drop down year ======================================
            $.ajax({
                method: "GET",
                url: "/api/item/Year"
            }).done(function (data, state, xhr) {
                if (data.length == 0) {
                    getItem();
                } else {
                    selectedyear = data[0].Year
                    var values = [];
                    for (let i = 0; i < data.length; i++) {
                        values[i] = [data[i].Year]
                    }
                    // values[data.length] = data[0].Year
                    // $('.fixyear').toggleClass("a");
                    $('.fixyear').removeClass("input-group ml-5 mt-3");
                    // $('.fixyear').toggleClass("fixyear input-group mt-1");
                    $('.fixyear').addClass("fixyear input-group ml-3 mt-3");
                    $('.year').append($(document.createElement('select')).prop({

                        class: 'year',
                        name: 'year',
                        style: 'border-color: white',
                        // class: ' year',
                        id: 'Year',
                        name: 'Year'
                    })
                    )


                    //drop down status year
                    for (let i = 0; i <= values.length - 1; i++) {
                        $('#Year').append($(document.createElement('option')).prop({
                            value: values[i],
                            text: values[i],
                            // class: values[i]
                        }))
                    }

                    getItem();
                    $('.ปีตรวจ').hide()

                    $('select.year').change(function () {
                        var selected = $(this).children("option:selected").val();
                        SelectedYear = selected
                        // SelectedYear = $("#Year").val();
                        // alert(SelectedYear)
                        $("#Location").children().remove().end().append('<option selected id="hidelocation" value="สถานที่">สถานที่</option>');
                        $("#Status").children().remove().end().append('<option selected id="hidestatus" value="สถานะ">สถานะ</option>');
                        $("#Email_Committee").children().remove().end().append('<option selected id="hidecommittee" value="คณะกรรมการผู้ตรวจสอบ">คณะกรรมการผู้ตรวจสอบ</option>');
                        $("#Room").children().remove().end().append('<option selected id="hideroom" value="ห้อง">ห้อง</option>');
                        $.ajax({
                            method: "GET",
                            url: "/api/item/dashboard/showAllInfo4/" + selected
                        }).done(function (dataSet, state, xhr) {
                            getItem()

                        }).fail(function (xhr, state, error) {
                        })

                    })
                }

            })


            $("#all").click(function () {
                window.location.replace("/api/information");
            });

            //======================= เปลี่ยน font PDF ========================
            pdfMake.fonts = {
                THSarabun: {
                    normal: 'THSarabun.ttf',
                    bold: 'THSarabun-Bold.ttf',
                    italics: 'THSarabun-Italic.ttf',
                    bolditalics: 'THSarabun-BoldItalic.ttf'
                }
            }
            //======================= เปลี่ยน font PDF จบ ========================

            //=======================สร้างโครง DataTable =========================

            table = $('#myTable').DataTable({

                'columnDefs': [
                    {
                        'targets': 0,
                        'checkboxes': {
                            'selectRow': true
                        }
                    }
                ],
                'select': {
                    'style': 'multi',
                    // 'selector': 'td:first-child'
                },
                'order': [[1, 'asc']],
                deferRender: true,
                columns: [
                    // { className: "my_class", "targets": [2] },
                    { data: "Inventory_Number" },//0
                    { data: "Asset_Number", title: "Asset_Number", "visible": false },//1
                    {
                        "mData": "Image", title: "รูปภาพ",
                        "render": function (data) {
                            return '<img class="pic" src="' + data + '" style="width: 100px;margin: 25px;-webkit-transition: all .4s ease-in-out;-moz-transition: all .4s ease-in-out;-o-transition: all .4s ease-in-out; -ms-transition: all .4s ease-in-out; "  />';
                        }
                        , className: "classimg",
                    },
                    { data: "Inventory_Number", title: "รหัสครุภัณฑ์", className: "classimg" },//3
                    { data: "Asset_Description", title: "ชื่อครุภัณฑ์", className: "classimg" },//4
                    { data: "Model", title: "ยี่ห้อ/รุ่น", "visible": false },//5
                    { data: "Serial", title: "Serial number", "visible": false },//6
                    { data: "Location", title: "สถานที่", className: "classimg" },//7
                    { data: "Room", title: "ห้อง", className: "classimg" },//8
                    { data: "Received_date", title: "วันที่รับทรัพย์สิน", "visible": false },//9
                    { data: "Original_value", title: "Original value", "visible": false },//10
                    { data: "Cost_center", title: "Cost Center", "visible": false },//11
                    { data: "Department", title: "หน่วยงาน", "visible": false },//12
                    { data: "Vendor_name", title: "Vendor Name1", "visible": false },//13
                    { data: "Takepicture", title: "ถ่ายรูป", className: "classimg" },//14
                    { data: "Date_scan", title: "วันที่ตรวจสอบ", className: "classimg" },//15
                    { data: "Email_Committee", title: "ผู้ตรวจสอบ", className: "classimg" },//16
                    { data: "Status", title: "สถานะ", className: "classimg" },//17
                ],

            });


            var aa = new $.fn.dataTable.Buttons(table, {

                "buttons": [
                    {
                        "extend": 'excel',
                        "exportOptions": {
                            "columns": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 17]
                        },

                    },
                    { // กำหนดพิเศษเฉพาะปุ่ม pdf
                        "extend": 'pdf', // ปุ่มสร้าง pdf ไฟล์
                        "text": 'PDF', // ข้อความที่แสดง
                        "pageSize": 'A4',   // ขนาดหน้ากระดาษเป็น A4 
                        "exportOptions": {
                            "columns": [3, 4, 7, 8, 10, 15, 16, 17]
                        },
                        "customize": function (doc) { // ส่วนกำหนดเพิ่มเติม ส่วนนี้จะใช้จัดการกับ pdfmake
                            // กำหนด style หลัก
                            doc.defaultStyle = {
                                font: 'THSarabun',
                                fontSize: 16
                            };
                            doc.styles.tableHeader.fontSize = 16
                            // กำหนดความกว้างของ header แต่ละคอลัมน์หัวข้อ
                            doc.content[1].table.widths = ['auto', 'auto', 'auto', 'auto', 'auto', 'auto', 'auto', 'auto'];
                        }
                    }, // สิ้นสุดกำหนดพิเศษปุ่ม pdf
                    {
                        "extend": 'print',
                        "exportOptions": {
                            "columns": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17]
                        },

                    },
                    // 'print'
                ],
            }).container().appendTo($('#ExportFile'));

            //======================= สร้างโครง DataTable จบ =========================


            //============================ Take photot ===========================
            $("#TakePhoto").click(function () {

                var rows_selected = table.column(0).checkboxes.selected();
                let rowdata = rows_selected.join(",")
                const arr = rowdata.split(",");
                SelectedYear = $("#Year").val();
                var takephoto = $("#TakePhoto").val();

                if (rows_selected.length != 0) {
                    $.ajax({
                        method: "put",
                        url: "/api/item/take/" + SelectedYear,
                        data: { records: arr, Status: takephoto },
                        success: function (response) {

                            swal({
                                title: "<small>บันทึกสำเร็จ</small>",
                                type: "success",
                                showCancelButton: false,
                                confirmButtonClass: "btn-success rounded",
                                confirmButtonText: "ยืนยัน",
                                closeOnConfirm: true,
                                html: true,
                                closeOnCancel: true
                            },
                                function (isConfirm) {
                                    if (isConfirm) {
                                        window.location.reload()
                                    }
                                });
                        }
                    });

                }
                else {
                    swal({
                        title: "กรุณาเลือกข้อมูล",
                        type: "info",
                        showCancelButton: false,
                        confirmButtonClass: "btn-primary rounded",
                        confirmButtonText: "ตกลง",
                        closeOnConfirm: true,
                    })
                }
            });
            //============================ Take photot จบ ===========================

            //============================ No Take photot ===========================

            $("#NoTakePhoto").click(function (e) {
                var rows_selected = table.column(0).checkboxes.selected();
                let rowdata = rows_selected.join(",")
                const arr = rowdata.split(",");
                SelectedYear = $("#Year").val();
                var NoTakePhoto = $("#NoTakePhoto").val();

                if (rows_selected.length != 0) {
                    $.ajax({
                        method: "put",
                        url: "/api/item/take/" + SelectedYear,
                        data: { records: arr, Status: NoTakePhoto },
                        success: function (response) {
                            swal({
                                title: "<small>บันทึกสำเร็จ</small>",
                                type: "success",
                                showCancelButton: false,
                                confirmButtonClass: "btn-success rounded",
                                confirmButtonText: "ยืนยัน",
                                closeOnConfirm: true,
                                html: true,
                                closeOnCancel: true
                            },
                                function (isConfirm) {
                                    if (isConfirm) {
                                        getItem();
                                    }
                                });
                        }
                    });

                }
                else {
                    swal({
                        title: "กรุณาเลือกข้อมูล",
                        type: "info",
                        showCancelButton: false,
                        confirmButtonClass: "btn-primary rounded",
                        // cancelButtonClass: "btn-primary",
                        confirmButtonText: "ตกลง",
                        // cancelButtonText: "ยกเลิก",
                        closeOnConfirm: true,
                        // closeOnCancel: true
                    })
                }


            });
            //============================ No Take photot จบ ===========================


            $.ajax({
                method: "GET",
                url: "/api/profile/infouser"
            }).done(function (data, state, xhr) {
                user = data.email
                $("#user").html(data.name);
                document.getElementById('pic').src = data.photo;
                if (data.email === undefined) {
                    window.location.replace("/api/checkpage")
                } else {
                    $.ajax({
                        method: "GET",
                        url: "/api/manageUser/showAllUsers/" + data.email
                    }).done(function (dataSet, state, xhr) {
                        if (dataSet[0] === undefined || dataSet[0].data === 0) {
                            window.location.replace("/api/checkpage")
                        }
                        if (dataSet[0].Role == 2) {
                            $("#DateManage").hide();
                            $("#manageu").hide();
                            $("#take").hide();
                            $("#import").hide();
                            $("#admin_history").hide();
                            $("#News_announce").hide();
                        }
                        if (dataSet[0].Role == 1 || dataSet[0].Role == 3) {
                            $("#userhistory").hide();

                        }
                        for (let i = 0; i < dataSet.length; i++) {
                            if (dataSet[i].Role == 2) {
                                dataSet[i].Role = "กรรมการ"
                            } else if (dataSet[i].Role == 1 || dataSet[i].Role == 3) {
                                dataSet[i].Role = "ผู้ดูแลระบบ"
                            } else {
                                dataSet[i].Role = "ผู้ดูแลถาวร"
                            }
                        }
                        $("#rol2").html(dataSet[0].Role)

                    }).fail(function (xhr, state, error) {
                        $(".alertText").html(xhr.responseText)
                        $("#alertmodal").modal();
                    });
                }
            }).fail(function (xhr, state, error) {
                //get data failed
                $(".alertText").html(xhr.responseText)
                $("#alertmodal").modal();
            });
        });

        function getItem() {
            //get users from DB
            SelectedYear = $("#Year").val();

            $('#myTable tbody').on('click', 'td.classimg', function () {
                var data = table.row(this).data();
                var inven = data.Inventory_Number
                // console.log(table.length)
                $.ajax({
                    method: "GET",
                    url: "/api/item5/" + inven + '/' + SelectedYear
                }).done(function (dataSet, state, xhr) {
                    // console.log(dataSet[0].Inventory_Number)
                    if (dataSet[0].Image === null) {
                        var PopImage = "/img/noimg.png"
                    }
                    else {
                        PopImage = "upload/Image/" + dataSet[0].Image
                    }
                    if (dataSet[0].Room === "") {
                        dataSet[0].Room = 'ไม่ปรากฏ'
                    }
                    if (dataSet[0].Location === "") {
                        dataSet[0].Location = 'ไม่ระบุสถานที่'
                    }
                    document.getElementById('picmodal').src = PopImage;
                    $(".date").html("<strong>วันที่ได้รับ : </strong> " + dataSet[0].Received_date + '<br>' + "<strong> วันที่นำเข้า :</strong> " + dataSet[0].Date_Upload)
                    $("#Inventory_Number").html(dataSet[0].Inventory_Number)
                    $("#des").html("<strong>คำอธิบาย :</strong> " + dataSet[0].Asset_Description)
                    $("#mod").html("<strong>โมเดล : </strong> " + dataSet[0].Model + '<br>' + " <strong> ซีเรียล : </strong>" + dataSet[0].Serial + '<br>' + " <strong> สถานที่ : </strong>" + dataSet[0].Location + "-" + dataSet[0].Room)
                    $("#cos").html("<strong> รหัสแผนก : </strong>" + dataSet[0].Cost_center + '<br>' + "   <strong> แผนกที่จัดเก็บ : </strong> " + dataSet[0].Department)
                    $("#value").html("<strong> มูลค่า : </strong>" + dataSet[0].Original_value + " บาท" + '<br>' + "  <strong> แหล่งที่มา : </strong>" + dataSet[0].Vendor_name)
                    $(".bd-example-modal-lg").modal();

                }).fail(function (xhr, state, error) {
                    //get data failed
                    alert(xhr.responseText);
                });
            });

            $.ajax({
                method: "GET",
                url: "/api/item/dashboard/showAllInfo4/" + SelectedYear
            }).done(function (dataSet, state, xhr) {
                // console.log(dataSet.length)

                if (dataSet.length == 0) {
                    swal({
                        title: "ไม่พบข้อมูลครุภัณฑ์",
                        type: "info",
                        confirmButtonClass: "btn-primary rounded",
                        confirmButtonText: "ตกลง",
                        closeOnConfirm: true,
                    },
                        // function (isConfirm) {
                        //     if (isConfirm) {
                        //         window.location.reload();
                        //     }
                        // }
                    )
                    // alert('aaaaaaaa')
                    // console.length(dataSet.length)
                }

                // Takepicture
                for (let i = 0; i < dataSet.length; i++) {
                    if (dataSet[i].Status == 0) {
                        dataSet[i].Status = "สูญหาย"
                    } else if (dataSet[i].Status == 1) {
                        dataSet[i].Status = "ปกติ"
                    } else if (dataSet[i].Status == 2) {
                        dataSet[i].Status = "เสื่อมสภาพ"
                    }
                    if (dataSet[i].Room === "") {
                        dataSet[i].Room = 'ไม่ปรากฏ'
                    }
                    if (dataSet[0].Location === "") {
                        dataSet[0].Location = 'ไม่ระบุสถานที่'
                    }
                }
                for (let i = 0; i < dataSet.length; i++) {
                    if (dataSet[i].Takepicture == 0) {
                        dataSet[i].Takepicture = "ไม่ต้องการรูปภาพ"
                    } else if (dataSet[i].Takepicture == 1) {
                        dataSet[i].Takepicture = "ต้องการรูป"
                    }
                    var nf = new Intl.NumberFormat();
                    dataSet[i].Original_value = nf.format(dataSet[i].Original_value);
                    if (dataSet[i].Image === null) {
                        dataSet[i].Image = "/img/noimg.png"
                    } else {
                        let img = dataSet[i].Image
                        dataSet[i].Image = 'upload/Image/' + img
                    }
                }
                table.clear();
                table.rows.add(dataSet).draw();

                // console.log(dataSet)
                // $('#myTable td[0]').addClass("label-warning");
                $(".dt-buttons").prop('class', 'text-center  mb-2');
                $(".dt-button.buttons-excel.buttons-html5").prop('class', 'btn btn-success excel rounded mr-2 mb-2');
                $(".dt-button.buttons-print").prop('class', 'btn btn-primary print rounded mb-2');
                $(".dt-button.buttons-pdf.buttons-html5").prop('class', 'btn btn-danger pdf rounded mr-2 mb-2');


                // ========== Print Qrcode ================
                $("#qrcode").click(function () {

                    var rows_selected1 = table.column(0).checkboxes.selected();
                    var selectedItemQR = [];

                    if (rows_selected1.length != 0) {

                        $.each(rows_selected1, function (index, value) {
                            selectedItemQR.push(value);
                        });
                        let jsobject = JSON.stringify(selectedItemQR)
                        sessionStorage.selectedItemQR = jsobject

                        window.open('/api/printqrcode', '_blank');
                    } else {
                        swal({
                            title: "กรุณาเลือกข้อมูล",
                            type: "info",
                            showCancelButton: false,
                            confirmButtonClass: "btn-primary rounded",
                            confirmButtonText: "ตกลง",
                            closeOnConfirm: true,
                        })
                    }
                });

                // ========== Print Qrcode End ================

                // ========== Print Barcode ================

                $("#barcode").click(function () {

                    var rows_selected1 = table.column(0).checkboxes.selected();
                    var selectedItemBR = [];

                    if (rows_selected1.length != 0) {

                        $.each(rows_selected1, function (index, value) {
                            selectedItemBR.push(value);
                        });
                        let jsobject = JSON.stringify(selectedItemBR)
                        sessionStorage.selectedItemBR = jsobject

                        window.open('/api/printbarcode', '_blank');
                    } else {
                        swal({
                            title: "กรุณาเลือกข้อมูล",
                            type: "info",
                            showCancelButton: false,
                            confirmButtonClass: "btn-primary rounded",
                            confirmButtonText: "ตกลง",
                            closeOnConfirm: true,
                        })
                    }
                });

                // ========== Print Barcode End ================


                // ========== Drop Down Location ===============
                $.ajax({
                    method: "GET",
                    url: "/api/item/Location/" + SelectedYear
                }).done(function (data, state, xhr) {

                    for (let i = data.length - 1; i >= 0; i--) {
                        // let id = data[i].Location;
                        if (data[i].Location === "") {
                            var id = 'ไม่ระบุสถานที่';
                        }
                        else {
                            id = data[i].Location;
                        }
                        $("#Location").append("<option value='" + id + "'>" + id + "</option>");
                    }
                    $('#hidelocation').hide()

                    $('#Location').change(function () {
                        var selected = $(this).children("option:selected").val();
                        if (selected == "ไม่ระบุสถานที่") {
                            selected = ' '
                        }
                        // console.log(selected)

                        $("#Status").val('สถานะ')
                        $("#Email_Committee").val('คณะกรรมการผู้ตรวจสอบ')
                        $("#Room").val('ห้อง')



                        $.ajax({
                            method: "GET",
                            url: "/api/item/dashboard/showAllInfoall/" + selected + "/" + SelectedYear
                        }).done(function (dataSet, state, xhr) {
                            for (let i = 0; i < dataSet.length; i++) {
                                if (dataSet[i].Status == 0) {
                                    dataSet[i].Status = "สูญหาย"
                                } else if (dataSet[i].Status == 1) {
                                    dataSet[i].Status = "ปกติ"
                                } else if (dataSet[i].Status == 2) {
                                    dataSet[i].Status = "เสื่อมสภาพ"
                                }
                                if (dataSet[i].Room === "") {
                                    dataSet[i].Room = 'ไม่ปรากฏ'
                                }
                                if (dataSet[i].Location === "") {
                                    dataSet[i].Location = 'ไม่ระบุสถานที่'
                                }
                            }
                            for (let i = 0; i < dataSet.length; i++) {
                                if (dataSet[i].Takepicture == 0) {
                                    dataSet[i].Takepicture = "ไม่ต้องการรูปภาพ"
                                } else if (dataSet[i].Takepicture == 1) {
                                    dataSet[i].Takepicture = "ต้องการรูป"
                                }
                                var nf = new Intl.NumberFormat();
                                dataSet[i].Original_value = nf.format(dataSet[i].Original_value);
                                if (dataSet[i].Image === null) {
                                    dataSet[i].Image = "/img/noimg.png"
                                } else {
                                    let img = dataSet[i].Image
                                    dataSet[i].Image = 'upload/Image/' + img
                                }
                            }
                            table.clear();
                            table.rows.add(dataSet).draw();
                        })
                    })
                })
                // ========== Drop Down Location End ================

                // ========== Drop Down Room ===============
                $.ajax({
                    method: "GET",
                    url: "/api/item/Room/" + SelectedYear
                }).done(function (data, state, xhr) {
                    // console.log(data)

                    for (let i = data.length - 1; i >= 0; i--) {
                        if (data[i].Room === "") {
                            var id = 'ไม่ปรากฏ';

                        }
                        else {
                            id = data[i].Room;
                        }


                        $("#Room").append("<option value='" + id + "'>" + id + "</option>");
                    }
                    $('#hideroom').hide()

                    $('#Room').change(function () {
                        var selected = $(this).children("option:selected").val();

                        if (selected == "ไม่ปรากฏ") {
                            selected = ' '
                        }
                        // console.log(selected)
                        $("#Status").val('สถานะ')
                        $("#Email_Committee").val('คณะกรรมการผู้ตรวจสอบ')
                        $("#Location").val('สถานที่')


                        $.ajax({
                            method: "GET",
                            url: "/api/item/dashboard/showAllInfo/" + selected + "/" + SelectedYear
                        }).done(function (dataSet, state, xhr) {
                            for (let i = 0; i < dataSet.length; i++) {
                                if (dataSet[i].Status == 0) {
                                    dataSet[i].Status = "สูญหาย"
                                } else if (dataSet[i].Status == 1) {
                                    dataSet[i].Status = "ปกติ"
                                } else if (dataSet[i].Status == 2) {
                                    dataSet[i].Status = "เสื่อมสภาพ"
                                }
                                if (dataSet[i].Room === "") {
                                    dataSet[i].Room = 'ไม่ปรากฏ'
                                }
                                if (dataSet[i].Location === "") {
                                    dataSet[i].Location = 'ไม่ระบุสถานที่'
                                }
                            }
                            for (let i = 0; i < dataSet.length; i++) {
                                if (dataSet[i].Takepicture == 0) {
                                    dataSet[i].Takepicture = "ไม่ต้องการรูปภาพ"
                                } else if (dataSet[i].Takepicture == 1) {
                                    dataSet[i].Takepicture = "ต้องการรูป"
                                }
                                var nf = new Intl.NumberFormat();
                                dataSet[i].Original_value = nf.format(dataSet[i].Original_value);
                                if (dataSet[i].Image === null) {
                                    dataSet[i].Image = "/img/noimg.png"
                                } else {
                                    let img = dataSet[i].Image
                                    dataSet[i].Image = 'upload/Image/' + img
                                }
                            }
                            table.clear();
                            table.rows.add(dataSet).draw();
                        })
                    })
                })
                // ========== Drop Down Room End ================

                // ========== Drop Down Status ======================
                $.ajax({
                    method: "GET",
                    url: "/api/item/Status/" + SelectedYear
                }).done(function (data, state, xhr) {
                    for (let i = data.length - 1; i >= 0; i--) {
                        if (data[i].Status == 0) {
                            var id = "สูญหาย"
                        }
                        else if (data[i].Status == 1) {
                            var id = "ปกติ"
                        }
                        else if (data[i].Status == 2) {
                            var id = "เสื่อมสภาพ"
                        }
                        $("#Status").append("<option value='" + id + "'>" + id + "</option>");
                    }
                    $('#hidestatus').hide()
                    $('#Status').change(function () {
                        var selected = $(this).children("option:selected").val();
                        let num
                        if (selected == "เสื่อมสภาพ") {
                            num = 2
                        } else if (selected == "ปกติ") {
                            num = 1
                        } else if (selected == "สูญหาย") {
                            num = 0
                        }
                        $("#Location").val('สถานที่')
                        $("#Email_Committee").val('คณะกรรมการผู้ตรวจสอบ')
                        $("#Room").val('ห้อง')

                        $.ajax({
                            method: "GET",
                            url: "/api/item/dashboard/showAllInfostatus/" + num + "/" + SelectedYear
                        }).done(function (datastatus, state, xhr) {

                            for (let i = 0; i < datastatus.length; i++) {
                                if (datastatus[i].Status == 0) {
                                    datastatus[i].Status = "สูญหาย"
                                } else if (datastatus[i].Status == 1) {
                                    datastatus[i].Status = "ปกติ"
                                } else if (datastatus[i].Status == 2) {
                                    datastatus[i].Status = "เสื่อมสภาพ"
                                }
                                if (datastatus[i].Room === "") {
                                    datastatus[i].Room = 'ไม่ปรากฏ'
                                }
                                if (dataSet[i].Location === "") {
                                    dataSet[i].Location = 'ไม่ระบุสถานที่'
                                }
                            }
                            for (let i = 0; i < datastatus.length; i++) {
                                if (datastatus[i].Takepicture == 0) {
                                    datastatus[i].Takepicture = "ไม่ต้องการรูปภาพ"
                                } else if (datastatus[i].Takepicture == 1) {
                                    datastatus[i].Takepicture = "ต้องการรูป"
                                }
                                var nf = new Intl.NumberFormat();
                                datastatus[i].Original_value = nf.format(datastatus[i].Original_value);

                                if (datastatus[i].Image === null) {
                                    datastatus[i].Image = "/img/noimg.png"
                                } else {
                                    let img = datastatus[i].Image
                                    datastatus[i].Image = 'upload/Image/' + img
                                    // console.log('Status Image')
                                }
                            }
                            table.clear();
                            table.rows.add(datastatus).draw();
                        })
                    })
                })
                // ========== Drop Down Status End ==================



                // ========== Drop Down Committee ======================

                $.ajax({
                    method: "GET",
                    url: "/api/item/Email_Committee/" + SelectedYear
                }).done(function (data, state, xhr) {

                    for (let i = data.length - 1; i >= 0; i--) {

                        let id = data[i].Email_Committee;

                        $("#Email_Committee").append("<option value='" + id + "'>" + id + "</option> style='width: 100px;height: 20px;'");
                    }
                    $('#hidecommittee').hide()

                    $('#Email_Committee').change(function () {
                        var selected = $(this).children("option:selected").val();
                        $("#Status").val('สถานะ')
                        $("#Location").val('สถานที่')
                        $("#Room").val('ห้อง')

                        $.ajax({
                            method: "GET",
                            url: "/api/item/dashboard/showAllInfo3/" + selected + '/' + SelectedYear
                        }).done(function (dataSet, state, xhr) {
                            for (let i = 0; i < dataSet.length; i++) {
                                if (dataSet[i].Status == 0) {
                                    dataSet[i].Status = "สูญหาย"
                                } else if (dataSet[i].Status == 1) {
                                    dataSet[i].Status = "ปกติ"
                                } else if (dataSet[i].Status == 2) {
                                    dataSet[i].Status = "เสื่อมสภาพ"
                                } if (dataSet[i].Room === "") {
                                    dataSet[i].Room = 'ไม่ปรากฏ'
                                }
                                if (dataSet[i].Location === "") {
                                    dataSet[i].Location = 'ไม่ระบุสถานที่'
                                }
                            }
                            for (let i = 0; i < dataSet.length; i++) {
                                if (dataSet[i].Takepicture == 0) {
                                    dataSet[i].Takepicture = "ไม่ต้องการรูปภาพ"
                                } else if (dataSet[i].Takepicture == 1) {
                                    dataSet[i].Takepicture = "ต้องการรูป"
                                }
                                var nf = new Intl.NumberFormat();
                                dataSet[i].Original_value = nf.format(dataSet[i].Original_value);
                                if (dataSet[i].Image === null) {
                                    dataSet[i].Image = "/img/noimg.png"
                                } else {
                                    let img = dataSet[i].Image
                                    dataSet[i].Image = 'upload/Image/' + img
                                }
                            }

                            table.clear();
                            table.rows.add(dataSet).draw();
                        })
                    })
                })
                // ========== Drop Down Committee End ==================

            })

        }
    </script>

</head>

<body style="background-color:white">
    <div class="dashboard-main-wrapper">
        <!-- navbar -->
        <!-- ============================================================== -->
        <div class="dashboard-header">
            <nav class="navbar navbar-expand-lg bg-white fixed-top">
                <!-- <div class="row">
                    <div class="col-sm-2 ml-4">
                        <img src="img/logoit.JPG" style="width: 280px;">
                        <span class="border-left ml-3"></span>
                    </div>
                    <div class="col-md-8 ml-2 text-right ">
                        <h6 class="font-weight-bold " style="color: rgb(2, 121, 251);">ประจำปี</h6>
                    </div>
                    <div class="col-md- text-right ">

                        <h6 class="font-weight-bold atyear1" style="color: rgb(2, 121, 251);">ปี</h6>
                    </div>
                </div> -->
                <img src="/img/logoit.JPG" style="height: 50px;">
                <h6 class="font-weight-bold ml-5" style="color: rgb(2, 121, 251);">ประจำปี</h6>
                <h6 class="font-weight-bold atyear1 ml-2" style="color: rgb(2, 121, 251);">ปี</h6>

                <ul class="navbar-nav ml-auto navbar-right-top">

                    <li class="nav-item dropdown notification">

                        <ul class="dropdown-menu dropdown-menu-right notification-dropdown">

                            <li>
                                <div class="list-footer"> <a href="#">การแจ้งเตือนทั้งหมด</a></div>
                            </li>
                        </ul>
                    </li>

                    <li class="nav-item dropdown nav-user">
                        <a class="nav-link nav-user-img" href="#" id="navbarDropdownMenuLink2" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false"><img id="pic" src="/img/avatar-1.jpg"
                                alt="" class="user-avatar-md rounded-circle"></a>
                        <div class="dropdown-menu dropdown-menu-right nav-user-dropdown"
                            aria-labelledby="navbarDropdownMenuLink2">
                            <div class="nav-user-info">
                                <h5 class="mb-0 text-white nav-user-name user" id="user">Ruttathorn </h5>
                                <span class="status"></span><span class="ml-2" id="rol2"></span>
                            </div>
                            <a class="dropdown-item" href="/api/auth/logout"><i
                                    class="fas fa-power-off mr-2"></i>ออกจากระบบ</a>
                        </div>
                    </li>
                </ul>

            </nav>
        </div>
        <!-- ============================================================== -->
        <!-- จบ navbar -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- navbar ด้านข้าง -->
        <!-- ============================================================== -->
        <div class="nav-left-sidebar sidebar-light">
            <div class="menu-list">
                <nav class="navbar navbar-expand-lg navbar-light">
                    <a class="d-xl-none d-lg-none" href="#">Dashboard</a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav flex-column">

                            <li class="nav-item ">
                                <a class="nav-link" href="/api/mainpage" aria-expanded="false"><i
                                        class="fa fa-home"></i>หน้าหลัก
                                </a>
                                <div id="submenu-1" class="collapse submenu">
                                    <ul class="nav flex-column">

                                    </ul>
                                </div>
                            </li>
                            <li class="nav-item ">
                                <a class="nav-link" href="/api/adminhistory" aria-expanded="false" id="admin_history"><i
                                        class="fa fa-user"></i>ประวัติผู้ใช้งาน </a>
                                <div id="submenu-1" class="collapse submenu">
                                    <ul class="nav flex-column">

                                    </ul>
                                </div>
                            </li>
                            <li class="nav-item ">
                                <a class="nav-link " href="/api/User_history" aria-expanded="false" id="userhistory"><i
                                        class="fa fa-user"></i>โปรไฟล์ </a>
                                <div id="submenu-1" class="collapse submenu">
                                    <ul class="nav flex-column">

                                    </ul>
                                </div>
                            </li>

                            <li class="nav-item ">
                                <a class="nav-link" href="/api/dashboard" aria-expanded="false"><i
                                        class="fa fa-dashboard"></i>แดชบอร์ด </a>
                                <div id="submenu-1" class="collapse submenu">
                                    <ul class="nav flex-column">

                                    </ul>
                                </div>
                            </li>

                            <li class="nav-item ">
                                <a class="nav-link active" href="/api/asset" aria-expanded="false"><i
                                        class="fa fa-archive"></i>ครุภัณฑ์ </a>
                                <div id="submenu-1" class="collapse submenu">
                                    <ul class="nav flex-column">

                                    </ul>
                                </div>
                            </li>

                            <li class="nav-item ">
                                <a class="nav-link" href="/api/announce" aria-expanded="false" id="News_announce"><i
                                        class="fa fa-bullhorn"></i>ข่าวประชาสัมพันธ์ </a>
                                <div id="submenu-1" class="collapse submenu">
                                    <ul class="nav flex-column">

                                    </ul>
                                </div>
                            </li>

                            <li class="nav-item " id="manageu">
                                <a class="nav-link " href="/api/manageUser" aria-expanded="false"><i
                                        class="fa fa-edit"></i>จัดการผู้ใช้
                                </a>
                                <div id="submenu-1" class="collapse submenu">
                                    <ul class="nav flex-column">

                                    </ul>
                                </div>
                            </li>

                            <li class="nav-item" id="DateManage">
                                <a class="nav-link " href="/api/Date_manage" aria-expanded="false"><i
                                        class="fa fa-clock"></i>จัดการเวลา
                                </a>
                                <div id="submenu-1" class="collapse submenu">
                                    <ul class="nav flex-column">
                                    </ul>

                                </div>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>

        </div>
        <!-- เสร็จ navbar -->
        <!-- ============================================================== -->

        <div class="dashboard-wrapper">
            <div class="dashboard-finance">

                <!-- ============================================================== -->
                <!-- หัวกระดาษ  -->
                <!-- ============================================================== -->
                <div class="row mt-4">
                    <div class="nav">
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-6">
                            <div class="page-header ml-5">
                                <h2 class="">ครุภัณฑ์ </h2>
                            </div>
                        </div>

                        <!-- ======================================================== -->
                        <!-- ดรอปดาว -->
                        <!-- ======================================================== -->
                        <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-6">
                            <div class="fixyear input-group ml-5 mt-3">
                                <div class="input-group-append be-addon">
                                    <div class="btn-group" role="group">
                                        <div class="year"><span style="font-size: 18px;color: black;">ปี</span>

                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ============================================================== -->
                <!-- เสร็จหัวกระดาษ  -->
                <!-- ============================================================== -->
                <!-- แถบ -->
                <!-- ============================================================== -->
                <!--กราฟ-->
                <!-- ============================================================== -->
                <!-- <div class="row"> -->

                <!-- ============================================================== -->
                <!-- ============================================================== -->
                <!-- ตารางข้อมูล -->
                <!-- ============================================================== -->
                <!-- ============================================================== -->

                <div class="container mb-2" style="background-color: white;">
                    <div class="row">
                        <div class="col-md-6 ">

                        </div>
                        <div class="col-md-6">
                            <button class="btn btn-success rounded float-right" data-toggle="modal"
                                data-target="#modalPushExcel" id="#" style="width: 20%;">นำออกไฟล์</button>
                            <button class="btn btn-primary rounded float-right mr-2" data-toggle="modal"
                                data-target="#upload" id="import" style="width: 20%;">นำเข้าไฟล์</button>
                        </div>
                    </div>
                </div>


                <div class="container " style="background-color: white;">
                    <br>
                    <div class="row border border-light">
                        <div class="col-md-1">

                            <div class="btn-group mt-2" role="group">
                                <select id="Location" style="border: white;">
                                    <option id="hidelocation" value="สถานที่" selected>สถานที่</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-md-1">

                            <div class="btn-group mt-2" role="group">
                                <select id="Room" style="border: white;">
                                    <option id="hideroom" value="ห้อง" selected>ห้อง</option>
                                </select>
                            </div>
                        </div>

                        <div class="col-md-1">
                            <div class="btn-group  mt-2" role="group">
                                <select id="Status" style="border: white;">
                                    <option id="hidestatus" value="สถานะ" selected>สถานะ</option>
                                </select>
                            </div>

                        </div>

                        <div class="col-md-2">

                            <div class="btn-group mt-2" role="group">
                                <select id="Email_Committee" style="border: white;width: 180px;height: 20px;">
                                    <option id="hidecommittee" value="คณะกรรมการผู้ตรวจสอบ" selected>
                                        คณะกรรมการผู้ตรวจสอบ</option>
                                </select>
                            </div>
                        </div>


                        <div class="col-md-2">

                            <div class="btn-group " role="group">
                                <a href="/asset">
                                    <button type="button" href="#" class="btn"
                                        style="color: red;">ล้างการกรองทั้งหมด</button></a>
                            </div>
                        </div>
                        <!-- <br><br> -->


                        <!-- <button class="btn col-md-1" class="btn btn-primary" data-toggle="modal"
                                data-target="#upload" id="import">นำเข้าไฟล์</button>
                            <button class="btn col-md-1" class="btn btn-primary" data-toggle="modal"
                                data-target="#modalPushExcel" id="#">นำออกไฟล์</button> -->
                        <div class="col-md-6" style="position: absolute; left: 69%;">
                            <span>
                                <button class="btn dropdown-toggle " type="button" id="dropdownQR"
                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    สร้าง QR/BarCode
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownQR">
                                    <button class="dropdown-item" id="qrcode">สร้าง QRcode</button>
                                    <button class="dropdown-item" id="barcode">สร้าง Barcode</button>
                                </div>
                            </span>


                            <span>
                                <button class="btn dropdown-toggle " type="button" id="dropdownTackPic"
                                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    ตั้งค่าการถ่ายรูป
                                </button>
                                <div class="dropdown-menu" aria-labelledby="dropdownTackPic">
                                    <button class="dropdown-item" id="TakePhoto" value="1">ถ่ายรูป</button>
                                    <button class="dropdown-item" id="NoTakePhoto" value="0">ไม่ถ่ายรูป</button>
                                </div>
                            </span>
                        </div>
                    </div>
                    <br>
                    <!-- <div class="table-responsive-xl"> -->
                    <table id="myTable" class="table table-striped table-bordered" style="width:100%">
                    </table>
                </div>
            </div>

            <!-- ============================================================== -->
            <!-- จบตาราง -->
            <div class="modal fade" id="modalPushExcel" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-notify modal-info" role="document" style="width: 400px;">
                    <!--Content-->
                    <div class="modal-content text-center">
                        <!--Header-->
                        <div class="modal-header d-flex justify-content-center">
                            <p class="heading">นำออกไฟล์</p>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="CloseModal">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>

                        <!--Body-->
                        <div class="modal-body">

                            <i class="fas fa-bell fa-4x animated rotateIn mb-4"></i>

                            <p>กรุณาเลือกชนิดไฟล์ที่จะนำออก</p>

                        </div>

                        <!--Footer-->
                        <div class="modal-footer">
                            <div class="container mx-auto">

                                <div class="" id="ExportFile"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ============================================================== -->
            <!-- modal  -->
            <!-- ============================================================== -->

            <div class="modal fade bd-example-modal-md" id="upload" tabindex="-1" role="dialog"
                aria-labelledby="mySmallModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">นำเข้าไฟล์ Excel ไปยังระบบ</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <form method="post" enctype="multipart/form-data">
                                <input type="file" name="filetoupload" id="fileUpload" accept=".xlsx, .xls"><br>
                                <input type="submit" class="btn btn-primary rounded mt-3" value="นำเข้าไฟล์">
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ============================================================== -->
            <!-- เสร็จ modal  -->
            <!-- ============================================================== -->
            <div class="modal bd-example-modal-sm fade" id="alertmodal" tabindex="-1" role="dialog"
                aria-labelledby="mySmallModalLabel" data-backdrop="static" data-keyboard="false" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content" style="background-color : #3f3f3f">
                        <div class="modal-body">
                            <h5 style="color: #ffffff; font-weight:bold;">ประกาศ</h5>
                            <p class="alertText" style="color: white">กรุณาติดต่อเพื่อขอใช้บริการ</p>
                            <input class="btn btn-sm" type="button" value="ตกลง" data-dismiss="modal"
                                style="float: right; background-color: #0a72c1; color:white">
                            <div class="but"></div>
                        </div>


                    </div>
                </div>
            </div>
            <!-- ============================================================== -->
            <!-- เสร็จ modal  -->
            <!-- ============================================================== -->
            <!-- </div> -->

            <!-- ============================================================== -->
            <!-- modal  datatable -->
            <!-- ============================================================== -->
            <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
                aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">รายละเอียดครุภัณฑ์</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-5 mt-5 ml-3">
                                <img class="card-img-top mx-auto " id="picmodal" src="/img/Pixels.png" alt="Card image">
                            </div>
                            <div class="col-md-6 ">

                                <div class="card-body" style="color: black;">
                                    <div><span>
                                            <h3 id="Inventory_Number" class="font-weight-bold">
                                                711000100142033
                                                <!-- <p>สถานะ : สูญหาย</p> -->
                                            </h3>
                                        </span></div>

                                    <p class="date">วันที่ได้รับ : 2-20-2020 วันที่อัพโหลด : 2-20-2020</p>
                                    <p id="des">คำอธิบาย :
                                        โต๊ะยาวมากๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆๆ</p>
                                    <p id="mod">โมเดล : Gundum Expo ซีเรียล **** สถานที่ :E3</p>
                                    <p id="cos">รหัสแผนก : 1234 แผนกที่จัดเก็บ : สำนักเทคโนโลยีสารสนเทศ </p>
                                    <p id="value">ราคา : 500000 แหล่งที่มา : ร้านรับจ้างสารพัด ของคุณกิน</p> <br>
                                    <br> <br>
                                    <br>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- ============================================================== -->
            <!-- เสร็จ modal  -->
            <!-- ============================================================== -->

            <!-- footer  -->
            <!-- ============================================================== -->

            <!-- <div class="" style="background-color:  rgb(50, 50, 51);  ">
                <div class="row ml-5 mr-5" style="background-color: rgb(50, 50, 51);">
                    <div class="col-xs-12 col-sm-12 col-md-4 mt-5">
                        <h3>
                            <blockquote>
                                <img src="/img/itlogo.png">
                                <h4 style="color:azure;font-size:26px;">สำนักวิชาเทคโนโลยีสารสนเทศ</h4>
                                <div style="border: 0.5px solid red; width: 7cm;"></div>
                                <code style="color: azure;font-size: 20px;">มหาวิทยาลัยแม่ฟ้าหลวง</code>
                            </blockquote>
                        </h3>
                    </div>
                    <div class="col-xs-12 col-sm-6 col-md-4 mt-5">
                        <div class="copyright">
                            <h4 class="header-footer" style="color: azure;">ติดต่อ <br>
                                <div style="border: 1px solid red; width: 7cm;"></div>
                            </h4>
                            <p style="color: azure; font-size: 14px; font-weight: 200;">
                                สำนักวิชาเทคโนโลยีสารสนเทศ
                                <br>
                                มหาวิทยาลัยแม่ฟ้าหลวง
                                <br>
                                333 หมู่ 1 ตำบลท่าสุด อำเภอเมือง จังหวัดเชียงราย 57100
                                <br>
                                โทรศัพท์ 0 5391 6741-2
                                <br>
                                โทรสาร 0 5391 6743
                                <br>
                                อีเมล: itschool@mfu.ac.th
                            </p>
                            <p></p>
                            <ul class="mfu-social">

                                <a href="https://www.facebook.com/itschool.mfu.page/" target="_blank"
                                    class="facebook-icon mr-3">
                                    <i class="fab fa-facebook">

                                    </i>
                                </a>

                                <a href="https://www.youtube.com/channel/UCbvvlT0UyZHCYdPTXL7vHXQ/featured"
                                    target="_blank" class="youtube-icon">
                                    <i class="fab fa-youtube">

                                    </i>
                                </a>
                            </ul>
                            <p></p>
                        </div>
                    </div>
                    <div class="col-xs-12 col-sm-6 col-md-4 mt-5"><iframe
                            src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Fitschool.mfu.page%2F&amp;tabs=timeline&amp;width=340&amp;height=250&amp;small_header=true&amp;adapt_container_width=true&amp;hide_cover=false&amp;show_facepile=true&amp;appId"
                            width="100%" height="300" style="border:none;overflow:hidden" scrolling="no" frameborder="0"
                            allowtransparency="true" allow="encrypted-media"></iframe>
                    </div>

                </div>
                <a class="scroll-to-top" style="display: none;">
                    <i class="fa fa-long-arrow-up" aria-hidden="true"></i>
                </a>

            </div> -->
            <!-- ============================================================== -->
            <!-- ======================== เสร็จ footer ========================= -->
            <!-- ============================================================== -->
        </div>
    </div>
</body>
</html>